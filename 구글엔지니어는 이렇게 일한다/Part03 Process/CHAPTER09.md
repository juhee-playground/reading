# 오늘 읽은 내용

## CHAPTER 09 코드 리뷰

### TIL 3줄 요약

- 코드리뷰는 엔지니어를 이어주는 매개체, 테스트 등 거의 모든 다른 프로세스가 엮여 있는 최우선 개발 워크플로 이다.
- 코드리뷰 프로세스를 확장하려면 자동화가 중요하다.
- 코드를 읽는 사람에게 초점을 맞추어 최적화한다.

### TIL (Today I Learned) 날짜

2023.05.23

### 오늘 읽은 범위

9.2 코드 리뷰 @구글
구글에서는 승인을 얻으려면 3가지 측면에서 리뷰를 통과해야 한다.

[세가지 측면]

- 첫째, 다른 엔지니어로부터 정확성과 용이성을 평가받는다. 보통 팀원이 해주는데 동료 리뷰어가 코드가 충분히 괜찮아 본인다는 뜻으로 설정하는 LGTM 허가 플래그에 반영된다.
- 둘째, 변경되는 코드 영역을 관리하는 코드 소유자로부터 변경 코드가 적잘하다는 승인을 받는다.
        소유자는 자신이 맡은 디렉터리의 문지기 역활은 한다.
- 셋째 가독성 승인을 받는다. 변경 코드가 해당 언어의 스타일과 모범 사례를 잘 따르고 조직에서 기대하는 방식으로 작성되었는지를 검사받는다.

9.3 코드리뷰의 이점

- 코드가 정확한지 확인 해줍니다.
- 변경된 코드를 다른 엔지니어도 잘 이해합니다.
- 코드베이스가 일관되게 관리됩니다.
- 팀이 소유권(주인의식)을 더 강하게 느낍니다.
- 지식이 공유됩니다.
- 코드 리뷰 자체의 기록이 남습니다.

9.3.1 코드 정확성
리뷰어는 1차적으로 변경된 코드의 '정확성'을 확인해주며, 코드리뷰가 주는 가장 확실한 이점입니다.

9.3.2 코드 이해 용이성
코드는 작성되는 횟수보다 읽히는 횟수가 몇 배는 많으므로 이해하기 쉽게 작성하는게 매우 중요합니다.
리뷰어는 작성자가 선택한 설계를 존중하지만 코드가 이해하지 않으면 '고객은 항상 옳다' 관점에서 질문은 던져보는 것은 좋다.

코드의 정확성과 이해 용이성 검토는 다른 엔지니어가 LGTM을 주기 위해 평가하는 주요 기준이며 LGTM은 코드 리뷰를 승인하기 위한 필수 항목이다.

9.3.3 코드 일관성
코드는 일관되고 단순해야지 사람들이 쉽게 이해할 수 있고 리펙터링 도구가 더 쉽게 다룰 수 있다.
탄력 있는 코드가 됩니다. 코드 베이스의 모든 코드가 같은 패턴을 따른 다면 리펙터링 도구를 제작하기도 쉽습니다.

9.3.4 심리적, 문화적 이점

코드는 '자신의 것'이 아니라 협업을 통해 만들어진 **'조직의 공동 소유물'**임을 인식시켜주는 효과입니다.
대부분의 엔지니어는 '완벽하지만 개발에 너무 오래 걸리는' 코드보다 '제 역활을 하는' 코드가 낫다고 이야기할 것입니다.

9.3.5 지식 공유
코드 리뷰 중 피드백을 주고 받는 과정에서 정보가 교환 되며 지식 공유를 촉진시킨다.
코드 리뷰에서 양방향 정보 교환이 이루어집니다.

9.4 코드 리뷰 모범 사례

9.4.1 공손하고 전문가답게
리뷰어에게 전문가다움을 기대하는 만큼 작성자에게도 전문가다움이 요구됩니다.
'나'와 '나의 코드'를 동일시하지 말고, 내가 제안한 변경은 혼자의 것이 아닌 팀의 소유임을 잊지 말아라.
여러분이 선택한 방식에 대해 제기된 질문들에 흥분하지 말고 왜 그렇게 처리했는지 설명할 준비를 미리 해둬야 합니다.
코드를 이해하기 쉽고 유지보수가 쉽게 만드는 일도 작성자의 책임임을 기억하세요.

코드리뷰는 작성자와 리뷰어 모두에게 배움의 기회임을 기억하세요. 이 점만 잊지 않으면 어떤 의견 충돌도 감정싸움으로 번지지 않을 것입니다.

9.4.2 작게 변경하기
리뷰어에게나 작성자에게나 코드 리뷰는 단 하나의 문제만을다루는게 가장 이상적입니다.
'작은 변경' 이라 하면 일반적으로 변경되는 코드가 200줄 이하라는 뜻입니다.
작은 변경은 리뷰어의 부담을 줄여줍니다.
해당 변경이 코드베이스를 건실하게 개선해주며 오래도록 유지보수하기에 문제가 없는지에만 집중해 판단하면 됩니다.

9.4.3 변경 설명 잘쓰기
변경 설명의 첫 줄은 어떤 종류의 변경인지를 잘 요약해야 합니다.
첫 줄이 변경 전체를 요약해주지만, 구체적으로 무엇을 왜 변경하는지 알려주는 자세한 설명 역시 필요합니다.

9.4.4 리뷰어는 최소한으로
구글에서 이루어지는 대부분의 코드 리뷰는 정화히 한 명의 리뷰어만으로 진행되다.

9.4.5 가능한 한 자동화하기
프로세스 중 자동화 할 수 있는 요소가 있다면 자동화하세요.
구글에서는 테스트, 린터, 포맷터를 작성자가 직접 수행할 필요가 없습니다. 거의 모든 코든 리뷰도구가 소위 프리서브밋 과정에서 자동으로 수행된다.
자동화는 코드 리뷰 프로세스에 도움됨은 물론 리뷰어가 포맷팅보다 더 중요한 문제에 집중하도록 도와준다.

9.5 코드 리뷰 유형

- 그린필드 리뷰와 새로운 기능 개발
- 동작 변경, 개선, 최적화
- 버그 수정과 롤백
- 리펙터링과 대규모 변경

9.5.1 그린필드 코드 리뷰
완전히 새로운 코드를 대상으로 하는 가장 드문 유형의 코드 리뷰. 
대상 코드가 오랜 기간 존속될 수 있는지를 평가하기에 가장 중요한 기회입니다.

코드가 지속 가능함을 보장하려면 API가 합의된 설계에 부합하고 테스트도 완벽히 이루어졌는지를 확인해야 한다.
설계문서도 검토하고 공개된 API에 단위 테스트가 존재해야 하며, 이 테스트들은 코드의 가정이 달라지면 실패해야 한다.

9.5.2 동작 변경, 개선, 최적화
구글에서 이루어지는 대부분의 변경은 코드베이스 안의 기존 코드를 수정하는 것.
그린 필드 리뷰의 지침이 그대로 적용.
꼭 필요한 변경인지, 코드베이스를 개선하는지
가장 바람직한 변경의 멋진 예로 '삭제'를 많이 거론한다.

9.5.3 버그 수정과 롤백
버그 수정은 온전히 그 버그를 잡는데만 집중해야 한다. 버그를 수정하면서 기능을 변경하는 다른 문제까지 묶어 처리하고픈 마음을 꾹 눌러야 한다.

9.5.4 리펙터링과 대규모 변경
구글에서는 많은 변경이 자동으로 생성된다. 변경의 작성자가 사람이 아니라 기계 대규모 변경(LSC) 프로세스라고 한다.
기계가 생성한 변경에도 리뷰가 필요하다. 위험성이 낮다고 생각되는 변경은 해당 코드에 관한 전권을 가진 리뷰어가 맡아서 처리하지만 위험도가 높거나 도메인 전문가가 필요한 변경은 다른 엔지니어들도 참여한다.
변경을 작게 유지하라는 앞서의 조언에만 부합하면 된다.

### 오늘 읽은 소감은? 떠오르는 생각을 가볍게 적어보세요

코드리뷰는 역시나 중요하다. 코드리뷰의 장점을 더욱 알게 해주는 장인 것 같다.

### 궁금한 내용이 있거나, 잘 이해되지 않는 내용이 있다면 적어보세요

X

### 해시태그: 키워드
#코드리뷰